<!DOCTYPE html>
<!--
This is a starter template page. Use this page to start your new project from
scratch. This page gets rid of all links and provides the needed markup only.
-->
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">

  <title>RainFLOW</title>

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="/plugins/fontawesome-free/css/all.min.css">
  <!-- Theme style -->
  
  <!-- Google Font: Source Sans Pro -->
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
  
  <!-- Leaflet -->
  <link rel="stylesheet" href="/css/leaflet.css">
  <link rel="stylesheet" href="/css/leaflet.label.css">
  <link rel = "stylesheet" href = "/css/adminlte.css">	
  <link rel = "stylesheet" href = "/css/adminlte.min.css">
 
  <link rel="stylesheet" href="/src/L.Control.Sidebar.css" />
    <!--[if lte IE 8]><link rel="stylesheet" href="https://cdn.leafletjs.com/leaflet-0.7.2/leaflet.ie.css" /><![endif]-->

	<link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />

<style>
html , body { height: 100%; overflow:hidden; padding:0; margin:0 }  
</style>

</head>
<body class="hold-transition sidebar-mini" style="height:100vh">
<div class="wrapper">

  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light hold-transition">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#"><i class="fas fa-bars"></i></a>
      </li>
	  <li>
	  <a href="#"><img src = "Logo.png" style ="width:150px;height:50px" alt = "RainFLOW Logo"></a>
	  </li>
    </ul>
	
   
    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">
	  <li>

		<a href="http://RainFLOW.live/dashboard"   class="nav-link"> LOGIN</a>

	  </i>
	  </li>
    </ul>
  </nav>
  <!-- /.navbar -->

  <!-- Main Sidebar Container -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="starter.html" class="brand-link">
	  <center>
      <span class="brand-text font-weight-bolder">RainFLOW</span>
	  </center>
    </a>


    <!-- Sidebar -->
    <div class="sidebar" >
      <!-- Sidebar user panel (optional) -->
	  <!-- <div class="user-panel mt-3 pb-3 mb-3 d-flex">
        <div class="image">
          <img src="/img/user2-160x160.jpg" class="img-circle elevation-2" alt="User Image">
        </div>
        <div class="info">
          <a href="#" class="d-block">User</a>
        </div>
     </div>
	 -->

	


      <!-- Sidebar Menu -->
	  <div>
      <nav class="mt-2" style="height:100vh">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
          <!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->
			
          <li class="nav-item has-treeview menu-open">
            <a href="#" class="nav-link active">
              <i class="nav-icon fas fa-cube"></i>
              <p>
                Node Filter
                <i class="right fas fa-angle-left"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item" id = "1" onclick = "filtersel(this.id)">
                <a href="/" class="nav-link active">
                  <i class="far fa-circle nav-icon"></i>
                  <p>All Nodes</p>
                </a>
              </li>
              <li class="nav-item" id = "2" onclick = "filtersel(this.id)">
                <a href="#" class="nav-link">
                  <i class="far fa-circle nav-icon"></i>
                  <p>RAFT Nodes</p>
                </a>
              </li>
			  <li class="nav-item" id = "3" onclick = "filtersel(this.id)">
                <a href="/mobile" class="nav-link">
                  <i class="far fa-circle nav-icon" ></i>
                  <p>Mobile Nodes</p>
                </a>
              </li>
			  <li class="nav-item" id = "4" onclick = "filtersel(this.id)">
                <a href="/flood" class="nav-link">
                  <i class="far fa-circle nav-icon" ></i>
                  <p>Flood Level</p>
                </a>
              </li>
			  <li class="nav-item" id = "5" onclick = "filtersel(this.id)">
                <a href="/rain" class="nav-link">
                  <i class="far fa-circle nav-icon" ></i>
                  <p>Rain Intensity</p>
                </a>
              </li>
		
            </ul>
          </li>
        </ul> 
      </nav>
      <!-- /.sidebar-menu -->
    </div>
    <!-- /.sidebar -->
  </aside>
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
	  <div id="map" style="width: 1280px%; height: 100vh"></div>
  </div>
  <!-- /.content-wrapper -->

</div>
<!-- ./wrapper -->
	
	<div id="sidebar" >

    </div>
<!-- REQUIRED SCRIPTS -->

<!-- jQuery -->
<script src="plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap 4 -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

<!-- AdminLTE App -->
<script src="/js/adminlte.min.js"></script>

<!-- Leaflet -->
<script src="/js/leaflet-src.js"></script>
<script src="/js/leaflet.label.js"></script>
<script src="/js/leaflet.canvas-markers.js"></script>
<script src="https://unpkg.com/leaflet-canvas-marker@0.2.0"></script>
<script src="/src/L.Control.Sidebar.js"></script>
<script src="/js/leaflet.geometryutil.js"></script>

<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>


 <script>
	var window_height = $(window).height(),
      header_height = $(".main-header").height();
$("#myDiv").css("height", window_height - header_height);

   $('[data-widget="pushmenu"]').PushMenu('collapse');



  var map = L.map('map').setView([14.6047, 120.97833], 18);
  var x = 0;

        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 20,
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox/streets-v11'
	}).addTo(map);
	
	var geocoder = L.Control.geocoder({
		position: 'topleft'
	}).addTo(map);

 

/////////////////////////// MARKER ICONS //////////////////////////////////////////
	var greengreen = L.icon({
    iconUrl: '1-1-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });

	var greenlime = L.icon({
    iconUrl: '1-2-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var greenyellow = L.icon({
    iconUrl: '1-3-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var greenorange = L.icon({
    iconUrl: '1-4-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var greenred = L.icon({
    iconUrl: '1-5-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  
  var limegreen = L.icon({
    iconUrl: '2-1-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });

	var limelime = L.icon({
    iconUrl: '2-2-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var limeyellow = L.icon({
    iconUrl: '2-3-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var limeorange = L.icon({
    iconUrl: '2-4-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var limered = L.icon({
    iconUrl: '2-5-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var yellowgreen = L.icon({
    iconUrl: '3-1-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });

	var yellowlime = L.icon({
    iconUrl: '3-2-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var yellowyellow = L.icon({
    iconUrl: '3-3-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var yelloworange = L.icon({
    iconUrl: '3-4-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var yellowred = L.icon({
    iconUrl: '3-5-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var orangegreen = L.icon({
    iconUrl: '4-1-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });

	var orangelime = L.icon({
    iconUrl: '4-2-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var orangeyellow = L.icon({
    iconUrl: '4-3-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var orangeorange = L.icon({
    iconUrl: '4-4-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var orangered = L.icon({
    iconUrl: '4-5-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var redgreen = L.icon({
    iconUrl: '5-1-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });

	var redlime = L.icon({
    iconUrl: '5-2-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var redyellow = L.icon({
    iconUrl: '5-3-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var redorange = L.icon({
    iconUrl: '5-4-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });
  
  var redred = L.icon({
    iconUrl: '5-5-01.png',

    iconSize: [20, 33], // size of the icon
    shadowSize: [50, 64], // size of the shadow
    iconAnchor: [10, 33], // point of the icon which will correspond to marker's location
    popupAnchor: [0, -55]
  });

 ////////////////////////////////////////////////////////////////////////////////
  
		
        var sidebar = L.control.sidebar('sidebar', {
            closeButton: true,
            position: 'right'
        });
        map.addControl(sidebar);

        setTimeout(function () {
            sidebar.hide();
        }, 500);

        


        map.on('click', function (e) {
          sidebar.toggle();
          sidebar.setContent("You clicked the map at " + e.latlng.toString());
        })

        sidebar.on('show', function () {
          console.log('Sidebar will be visible.');
          
        });

        sidebar.on('shown', function () {
          console.log('Sidebar is visible.');
          
        });

        sidebar.on('hide', function () {
            console.log('Sidebar will be hidden.');
        });

        sidebar.on('hidden', function () {
            console.log('Sidebar is hidden.');
        });

        L.DomEvent.on(sidebar.getCloseButton(), 'click', function () {
            console.log('Close button clicked.');
        });
	
 // ciLayer.addMarker(markerHome);
  //ciLayer.addMarker(markerSomewhere);
	var LOCmarker;
	var  arr = [];
	var IDcheck = 0;

        {{#each data}}
		
			console.log("IDcheck = " + IDcheck);
			if(IDcheck == {{polyID}} - 1){
			 
			} else{
			
			}
			
			IDcheck++;
			console.log("IDcheck now = " + IDcheck);
			
			console.log("GOD BLESS");
			
			if({{numID}} == 1)
			{
				var num01 = {{latitude}};
				var num02 = {{longitude}};
			}
			else if({{numID}} == 2)
			{
				var num03 = {{latitude}};
				var num04 = {{longitude}};
			}
			else if({{numID}} == 3)
			{
				var num05 = {{latitude}};
				var num06 = {{longitude}};
			}
			
			

			var flood = {{waterdepth}};
			var rain = {{rainintensity}};
			
			
				if(flood < 20){
					LOCmarker = greengreen;
				
					
				}else if(flood >= 20 && flood < 40){
					LOCmarker = limelime;
					
					
				}else if (flood >= 40 && flood <80){
					LOCmarker = yellowyellow;
					
					
				}else if (flood >= 80 && flood < 120){
					LOCmarker = orangeorange;
					
					
				}else if(flood >= 120){
					LOCmarker = redred;
					
				}
			
            var markerHome = L.marker([{{latitude}}, {{longitude}}], { icon: LOCmarker }).on('click', function () {
            sidebar.show();
			sidebar.setContent("<h2><b>" + '{{API_Key}}' + " RAFT Node!</b></h2><p>RAFT shows Flood Level at <b>" + {{waterdepth}} + "</b></p><p>RAFT shows Rain Intensity at <b>" + {{rainintensity}} + "</b></p>");
        }).addTo(map);
			markerHome.bindPopup("<center><b>RAFT Here!</b><br>Decriptive Flood Level <br>Decriptive Rain Intensity</center>");
		
		
		
		{{/each}}
		
		var polygon = L.polygon([
			[num01, num02],
			[num03, num04],
			[num05, num06]
]).addTo(map);
		
    </script>
</body>
</html>
